# Database Reset Scripts

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶å | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| `reset_database.md` | è¯¦ç»†çš„é‡ç½®æŒ‡å—å’Œè¯´æ˜ | éœ€è¦äº†è§£å®Œæ•´æµç¨‹æ—¶ |
| `auto_reset.sql` | ä¸€é”®é‡ç½®è„šæœ¬ | å®Œå…¨é‡ç½®æ•°æ®åº“åˆ°æœ€æ–°ç‰ˆæœ¬ |
| `create_tables.sql` | åˆ›å»ºè¡¨ç»“æ„è„šæœ¬ | æ‰‹åŠ¨åˆ›å»ºè¡¨ç»“æ„ |
| `delete_all_data.sql` | åˆ é™¤æ‰€æœ‰æ•°æ®è„šæœ¬ | æ¸…ç©ºæ•°æ®åº“ |
| `add_suggested_replies_column.sql` | å¿«é€Ÿä¿®å¤è„šæœ¬ | ä»…æ·»åŠ ç¼ºå¤±çš„å­—æ®µ |

## ğŸš€ å¿«é€Ÿä¿®å¤å½“å‰é”™è¯¯

å¦‚æœä½ é‡åˆ° `"Could not find the 'suggested_replies' column"` é”™è¯¯ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ1: å¿«é€Ÿä¿®å¤ï¼ˆæ¨èï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼‰
1. æ‰“å¼€ Supabase Dashboard
2. è¿›å…¥ SQL Editor
3. æ‰§è¡Œ `add_suggested_replies_column.sql` æ–‡ä»¶å†…å®¹

### æ–¹æ¡ˆ2: å®Œå…¨é‡ç½®ï¼ˆä¼šä¸¢å¤±æ‰€æœ‰æ•°æ®ï¼‰
1. å¤‡ä»½é‡è¦æ•°æ®ï¼ˆå¦‚æœéœ€è¦ï¼‰
2. æ‰§è¡Œ `auto_reset.sql`
3. æ¸…é™¤æµè§ˆå™¨ localStorage ä¸­çš„ `sb_inited`

## ğŸ“‹ å®Œæ•´é‡ç½®æ­¥éª¤

1. **å¤‡ä»½ç°æœ‰æ•°æ®**ï¼ˆå¯é€‰ï¼‰
   ```sql
   -- å¯¼å‡ºæ‰€æœ‰ä¼šè¯å’Œæ¶ˆæ¯æ•°æ®
   COPY chat_sessions TO 'sessions_backup.csv' WITH CSV HEADER;
   COPY messages TO 'messages_backup.csv' WITH CSV HEADER;
   ```

2. **æ‰§è¡Œé‡ç½®**
   ```sql
   -- åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ
   \i auto_reset.sql
   ```

3. **æ¸…ç†å®¢æˆ·ç«¯ç¼“å­˜**
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - è¿›å…¥ Application/Storage æ ‡ç­¾
   - æ¸…é™¤ localStorage ä¸­çš„ `sb_inited` å’Œ `supabaseConfig` é”®
   - åˆ·æ–°é¡µé¢

## ğŸ”§ éªŒè¯é‡ç½®ç»“æœ

é‡ç½®åï¼Œåº”ç”¨åº”è¯¥èƒ½å¤Ÿï¼š
- âœ… æ­£å¸¸å‘é€æ¶ˆæ¯
- âœ… ä¿å­˜æ€è€ƒè¿‡ç¨‹
- âœ… ä¿å­˜å»¶ä¼¸é—®é¢˜
- âœ… é¡µé¢åˆ·æ–°åæ¢å¤å®Œæ•´å¯¹è¯

## ğŸ“ Schema ç‰ˆæœ¬

- **v1.0**: åŸºç¡€è¡¨ç»“æ„ï¼ˆchat_sessions, messagesï¼‰
- **v1.1**: æ·»åŠ  suggested_replies å­—æ®µï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®ä¸¢å¤±**: å®Œå…¨é‡ç½®ä¼šåˆ é™¤æ‰€æœ‰å¯¹è¯å†å²
2. **å¼€å‘ç¯å¢ƒ**: å»ºè®®å…ˆåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•
3. **å¤‡ä»½**: ç”Ÿäº§ç¯å¢ƒé‡ç½®å‰åŠ¡å¿…å¤‡ä»½æ•°æ®
4. **æƒé™**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ•°æ®åº“æƒé™æ‰§è¡Œè¿™äº›æ“ä½œ

## ğŸ†˜ å¸¸è§é—®é¢˜

**Q: æ‰§è¡Œè„šæœ¬åè¿˜æ˜¯æŠ¥é”™ï¼Ÿ**
A: æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶é‡å¯åº”ç”¨

**Q: æ€ä¹ˆç¡®è®¤å­—æ®µæ·»åŠ æˆåŠŸï¼Ÿ**
A: æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢æ£€æŸ¥è¡¨ç»“æ„ï¼š
```sql
SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name='messages' AND table_schema='public';
```

**Q: å¯ä»¥ä¿ç•™ç°æœ‰æ•°æ®å—ï¼Ÿ**
A: ä½¿ç”¨ `add_suggested_replies_column.sql` è€Œä¸æ˜¯å®Œæ•´é‡ç½®